<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ä¹ã€Hystrixæ–­è·¯å™¨ | æŠ˜æœ¨Zxw</title><meta name="description" content="Hystrixæ–­è·¯å™¨æ¦‚è¿°åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿç»“æ„ä¸€èˆ¬éƒ½æœ‰å¾ˆå¤šä¾èµ–å…³ç³»ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå¾®æœåŠ¡å‡ºç°äº†é—®é¢˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¾èµ–å…¶çš„å…¶ä»–å¾®æœåŠ¡ä¹Ÿå‡ºç°é—®é¢˜ï¼Œä»è€Œå‘ç”Ÿâ€œé›ªå´©â€ã€‚  å¦‚ä¸Šæ‰€ç¤ºï¼ŒæœåŠ¡Dç”±äºå¤„ç†çš„è¯·æ±‚è¿‡å¤šï¼Œå¯¼è‡´å“åº”æ—¶é—´å˜é•¿ï¼Œä»è€Œå½±å“åˆ°äº†ä¾èµ–å¾®æœåŠ¡Dçš„å¾®æœåŠ¡Bï¼›åˆç”±äºå¾®æœåŠ¡Aä¾èµ–äº†å¾®æœåŠ¡Bï¼Œæ‰€ä»¥å¾®æœåŠ¡Aä¹Ÿè¢«å½±å“äº†ã€‚ å¯ä»¥çœ‹è§åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæœåŠ¡å‡ºç°äº†é—®é¢˜ï¼Œå°±å¯èƒ½å‡ºç°æœåŠ¡é›ªå´©ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€"><meta name="keywords" content="Hystrixæ–­è·¯å™¨"><meta name="author" content="æŠ˜æœ¨Zxw"><meta name="copyright" content="æŠ˜æœ¨Zxw"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://zxwzxh.github.io/2020/11/05/%E4%B9%9D%E3%80%81Hystrix%E6%96%AD%E8%B7%AF%E5%99%A8/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="ä¹ã€Hystrixæ–­è·¯å™¨"><meta property="og:url" content="http://zxwzxh.github.io/2020/11/05/%E4%B9%9D%E3%80%81Hystrix%E6%96%AD%E8%B7%AF%E5%99%A8/"><meta property="og:site_name" content="æŠ˜æœ¨Zxw"><meta property="og:description" content="Hystrixæ–­è·¯å™¨æ¦‚è¿°åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿç»“æ„ä¸€èˆ¬éƒ½æœ‰å¾ˆå¤šä¾èµ–å…³ç³»ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå¾®æœåŠ¡å‡ºç°äº†é—®é¢˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¾èµ–å…¶çš„å…¶ä»–å¾®æœåŠ¡ä¹Ÿå‡ºç°é—®é¢˜ï¼Œä»è€Œå‘ç”Ÿâ€œé›ªå´©â€ã€‚  å¦‚ä¸Šæ‰€ç¤ºï¼ŒæœåŠ¡Dç”±äºå¤„ç†çš„è¯·æ±‚è¿‡å¤šï¼Œå¯¼è‡´å“åº”æ—¶é—´å˜é•¿ï¼Œä»è€Œå½±å“åˆ°äº†ä¾èµ–å¾®æœåŠ¡Dçš„å¾®æœåŠ¡Bï¼›åˆç”±äºå¾®æœåŠ¡Aä¾èµ–äº†å¾®æœåŠ¡Bï¼Œæ‰€ä»¥å¾®æœåŠ¡Aä¹Ÿè¢«å½±å“äº†ã€‚ å¯ä»¥çœ‹è§åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæœåŠ¡å‡ºç°äº†é—®é¢˜ï¼Œå°±å¯èƒ½å‡ºç°æœåŠ¡é›ªå´©ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€"><meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><meta property="article:published_time" content="2020-11-05T10:28:49.000Z"><meta property="article:modified_time" content="2020-11-08T12:26:20.620Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="prev" title="åã€æœåŠ¡ç½‘å…³" href="http://zxwzxh.github.io/2020/11/08/%E5%8D%81%E3%80%81%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3/"><link rel="next" title="å…«ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨" href="http://zxwzxh.github.io/2020/11/05/%E5%85%AB%E3%80%81OpenFeign%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">75</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length_num">122</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length_num">15</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw categories"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Hystrixæ–­è·¯å™¨"><span class="toc-number">1.</span> <span class="toc-text">Hystrixæ–­è·¯å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#æ¦‚è¿°"><span class="toc-number">1.1.</span> <span class="toc-text">æ¦‚è¿°</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜"><span class="toc-number">1.1.1.</span> <span class="toc-text">åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hystrixæ˜¯ä»€ä¹ˆ"><span class="toc-number">1.1.2.</span> <span class="toc-text">Hystrixæ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hystrixèƒ½åšä»€ä¹ˆ"><span class="toc-number">1.1.3.</span> <span class="toc-text">Hystrixèƒ½åšä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hystrixåœæ­¢æ›´æ–°ï¼Œè¿›å…¥ç»´æŠ¤"><span class="toc-number">1.1.4.</span> <span class="toc-text">Hystrixåœæ­¢æ›´æ–°ï¼Œè¿›å…¥ç»´æŠ¤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hystrixé‡è¦æ¦‚å¿µ"><span class="toc-number">1.2.</span> <span class="toc-text">Hystrixé‡è¦æ¦‚å¿µ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡é™çº§"><span class="toc-number">1.2.1.</span> <span class="toc-text">æœåŠ¡é™çº§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡ç†”æ–­"><span class="toc-number">1.2.2.</span> <span class="toc-text">æœåŠ¡ç†”æ–­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡é™æµ"><span class="toc-number">1.2.3.</span> <span class="toc-text">æœåŠ¡é™æµ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Hystrixæ¡ˆä¾‹"><span class="toc-number">1.3.</span> <span class="toc-text">Hystrixæ¡ˆä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#é¡¹ç›®æ„å»º"><span class="toc-number">1.3.1.</span> <span class="toc-text">é¡¹ç›®æ„å»º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é«˜å¹¶å‘æµ‹è¯•"><span class="toc-number">1.3.2.</span> <span class="toc-text">é«˜å¹¶å‘æµ‹è¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#jmeterå‹åŠ›æµ‹è¯•"><span class="toc-number">1.3.3.</span> <span class="toc-text">jmeterå‹åŠ›æµ‹è¯•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#åŠ å…¥æ¶ˆè´¹è€…è¿›è¡Œæµ‹è¯•"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">åŠ å…¥æ¶ˆè´¹è€…è¿›è¡Œæµ‹è¯•</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å¦‚ä½•è§£å†³"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">å¦‚ä½•è§£å†³</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡é™çº§-1"><span class="toc-number">1.3.4.</span> <span class="toc-text">æœåŠ¡é™çº§</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æœåŠ¡æä¾›è€…æœåŠ¡é™çº§"><span class="toc-number">1.3.4.1.</span> <span class="toc-text">æœåŠ¡æä¾›è€…æœåŠ¡é™çº§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#æœåŠ¡æ¶ˆè´¹è€…æœåŠ¡é™çº§"><span class="toc-number">1.3.4.2.</span> <span class="toc-text">æœåŠ¡æ¶ˆè´¹è€…æœåŠ¡é™çº§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç›®å‰çš„é—®é¢˜"><span class="toc-number">1.3.4.3.</span> <span class="toc-text">ç›®å‰çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#è§£å†³é—®é¢˜"><span class="toc-number">1.3.4.4.</span> <span class="toc-text">è§£å†³é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æœåŠ¡ç†”æ–­-1"><span class="toc-number">1.3.5.</span> <span class="toc-text">æœåŠ¡ç†”æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æœåŠ¡ç†”æ–­æ˜¯ä»€ä¹ˆ"><span class="toc-number">1.3.5.1.</span> <span class="toc-text">æœåŠ¡ç†”æ–­æ˜¯ä»€ä¹ˆ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®æˆ˜"><span class="toc-number">1.3.5.2.</span> <span class="toc-text">å®æˆ˜</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ç†”æ–­ç±»å‹"><span class="toc-number">1.3.5.3.</span> <span class="toc-text">ç†”æ–­ç±»å‹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å®˜ç½‘æ–­è·¯å™¨æµç¨‹"><span class="toc-number">1.3.5.4.</span> <span class="toc-text">å®˜ç½‘æ–­è·¯å™¨æµç¨‹</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æœåŠ¡ç›‘æ§hystrixDashboard"><span class="toc-number">1.4.</span> <span class="toc-text">æœåŠ¡ç›‘æ§hystrixDashboard</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ä½¿ç”¨ç¤ºä¾‹"><span class="toc-number">1.4.1.</span> <span class="toc-text">ä½¿ç”¨ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ€ä¹ˆçœ‹"><span class="toc-number">1.4.2.</span> <span class="toc-text">æ€ä¹ˆçœ‹</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">æŠ˜æœ¨Zxw</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw tags"></i><span> æ ‡ç­¾</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw categories"></i><span> åˆ†ç±»</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> å‹é“¾</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">ä¹ã€Hystrixæ–­è·¯å™¨</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="å‘è¡¨äº 2020-11-05 18:28:49"><i class="far fa-calendar-alt fa-fw"></i> å‘è¡¨äº 2020-11-05</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="æ›´æ–°äº 2020-11-08 20:26:20"><i class="fas fa-history fa-fw"></i> æ›´æ–°äº 2020-11-08</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/Web%E6%A1%86%E6%9E%B6/">Webæ¡†æ¶</a><i class="fas fa-angle-right post-meta__separator"></i><i class="fas fa-inbox fa-fw post-meta__icon"></i><a class="post-meta__categories" href="/categories/Web%E6%A1%86%E6%9E%B6/Spring-Cloud/">Spring Cloud</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="Hystrixæ–­è·¯å™¨"><a href="#Hystrixæ–­è·¯å™¨" class="headerlink" title="Hystrixæ–­è·¯å™¨"></a>Hystrixæ–­è·¯å™¨</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><h3 id="åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜"><a href="#åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜" class="headerlink" title="åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜"></a>åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜</h3><p>å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿç»“æ„ä¸€èˆ¬éƒ½æœ‰å¾ˆå¤šä¾èµ–å…³ç³»ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå¾®æœåŠ¡å‡ºç°äº†é—®é¢˜ï¼Œå¯èƒ½ä¼šå¯¼è‡´ä¾èµ–å…¶çš„å…¶ä»–å¾®æœåŠ¡ä¹Ÿå‡ºç°é—®é¢˜ï¼Œä»è€Œå‘ç”Ÿâ€œé›ªå´©â€ã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201105202640069.png" alt="image-20201105202640069"></p>
<p>å¦‚ä¸Šæ‰€ç¤ºï¼ŒæœåŠ¡Dç”±äºå¤„ç†çš„è¯·æ±‚è¿‡å¤šï¼Œå¯¼è‡´å“åº”æ—¶é—´å˜é•¿ï¼Œä»è€Œå½±å“åˆ°äº†ä¾èµ–å¾®æœåŠ¡Dçš„å¾®æœåŠ¡Bï¼›åˆç”±äºå¾®æœåŠ¡Aä¾èµ–äº†å¾®æœåŠ¡Bï¼Œæ‰€ä»¥å¾®æœåŠ¡Aä¹Ÿè¢«å½±å“äº†ã€‚</p>
<p>å¯ä»¥çœ‹è§åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªæœåŠ¡å‡ºç°äº†é—®é¢˜ï¼Œå°±å¯èƒ½å‡ºç°<strong>æœåŠ¡é›ªå´©</strong>ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå¤„ç†è¿™ç§é—®é¢˜çš„æ–¹æ³•ï¼Œè®©åœ¨æŸä¸ªå¾®æœåŠ¡å‘ç”Ÿé—®é¢˜æ—¶ç³»ç»Ÿèƒ½å¤Ÿæœ€å¤§é™åº¦çš„å‡å°æŸå¤±ï¼</p>
<h3 id="Hystrixæ˜¯ä»€ä¹ˆ"><a href="#Hystrixæ˜¯ä»€ä¹ˆ" class="headerlink" title="Hystrixæ˜¯ä»€ä¹ˆ"></a>Hystrixæ˜¯ä»€ä¹ˆ</h3><p>Hystrixæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„<strong>å»¶è¿Ÿ</strong>å’Œ<strong>å®¹é”™</strong>çš„å¼€æºåº“ã€‚åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œè®¸å¤šä¾èµ–ä¸å¯é¿å…çš„ä¼šè°ƒç”¨å¤±è´¥ï¼ˆæ¯”å¦‚è¶…æ—¶ã€å¼‚å¸¸ç­‰ï¼‰ï¼ŒHystrixèƒ½å¤Ÿä¿è¯åœ¨ä¸€ä¸ªä¾èµ–å‡ºé—®é¢˜çš„æƒ…å†µä¸‹ï¼Œ<strong>ä¸ä¼šå¯¼è‡´æ•´ä½“æœåŠ¡å¤±è´¥ï¼Œé¿å…çº§è”æ•…éšœï¼Œä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§</strong></p>
<p><strong>æ–­è·¯å™¨</strong>æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœä¹‹åï¼Œé€šè¿‡æ–­è·¯å™¨çš„æ•…éšœç›‘æ§ï¼ˆç±»ä¼¼ä¿é™©ä¸ç†”æ–­ï¼‰ï¼Œ<strong>å‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”ï¼ˆFallBackï¼‰ï¼Œè€Œä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ³•æ— æ³•å¤„ç†çš„å¼‚å¸¸</strong>ï¼Œè¿™æ ·å°±ä¿è¯äº†æœåŠ¡è°ƒç”¨æ–¹çš„çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´ã€ä¸å¿…è¦åœ°å ç”¨ï¼Œä»è€Œé¿å…åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶ï¼Œä¹ƒè‡³é›ªå´©ã€‚</p>
<p>å®˜æ–¹èµ„æ–™ï¼š<a href="https://github.com/Netflix/Hystrix/wiki/How-To-Use" target="_blank" rel="noopener">https://github.com/Netflix/Hystrix/wiki/How-To-Use</a></p>
<h3 id="Hystrixèƒ½åšä»€ä¹ˆ"><a href="#Hystrixèƒ½åšä»€ä¹ˆ" class="headerlink" title="Hystrixèƒ½åšä»€ä¹ˆ"></a>Hystrixèƒ½åšä»€ä¹ˆ</h3><ul>
<li><p>æœåŠ¡é™çº§</p>
</li>
<li><p>æœåŠ¡ç†”æ–­</p>
</li>
<li><p>æ¥è¿‘å®æ—¶çš„ç›‘æ§</p>
<p>ã€‚ã€‚ã€‚</p>
</li>
</ul>
<h3 id="Hystrixåœæ­¢æ›´æ–°ï¼Œè¿›å…¥ç»´æŠ¤"><a href="#Hystrixåœæ­¢æ›´æ–°ï¼Œè¿›å…¥ç»´æŠ¤" class="headerlink" title="Hystrixåœæ­¢æ›´æ–°ï¼Œè¿›å…¥ç»´æŠ¤"></a>Hystrixåœæ­¢æ›´æ–°ï¼Œè¿›å…¥ç»´æŠ¤</h3><p>è®¿é—®ï¼š<a href="https://github.com/Netflix/Hystrix" target="_blank" rel="noopener">https://github.com/Netflix/Hystrix</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201105204447103.png" alt="image-20201105204447103"></p>
<p>Hystrixå·²ç»åœæ­¢æ›´æ–°ï¼Œè¿›å…¥äº†ç»´æŠ¤çŠ¶æ€ï¼</p>
<ul>
<li>è¢«åŠ¨ä¿®å¤bugs</li>
<li>ä¸å†æ¥å—åˆå¹¶è¯·æ±‚</li>
<li>ä¸å†å‘å¸ƒæ–°ç‰ˆæœ¬</li>
</ul>
<p>è¿™é‡Œè¿˜æåˆ°äº†ï¼Œæ¨èä½¿ç”¨resilience4jæ¥æ›¿ä»£ã€‚ä½†æ˜¯ï¼Œå›½å†…ä¸€èˆ¬ä¼šä½¿ç”¨Sentinelæ¥æ›¿æ¢</p>
<h2 id="Hystrixé‡è¦æ¦‚å¿µ"><a href="#Hystrixé‡è¦æ¦‚å¿µ" class="headerlink" title="Hystrixé‡è¦æ¦‚å¿µ"></a>Hystrixé‡è¦æ¦‚å¿µ</h2><h3 id="æœåŠ¡é™çº§"><a href="#æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h3><p>fallback</p>
<p>å¯ä»¥è¿™æ ·æ¥æè¿°é™çº§</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>() &#123;</span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>() &#123;</span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span>() &#123;</span><br><span class="line">    </span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœåŠ¡é™çº§å°±ç›¸å½“äºè¿™ä¸ª<code>else {â€¦}</code>çš„ä½œç”¨ï¼Œå½“æœåŠ¡ä¸å¯ç”¨çš„æ—¶å€™ï¼Œéœ€è¦ä½¿ç”¨æœåŠ¡é™çº§æ¥<strong>å…œåº•</strong>ï¼Œå³å®åœ¨æ— æ³•è§£å†³å°±ä½¿ç”¨æœåŠ¡é™çº§æ¥è¿”å›ä¸€ä¸ªå‹å¥½çš„æç¤ºï¼ˆfallbackï¼‰</p>
<p><strong>å“ªäº›æƒ…å†µä¼šè§¦å‘é™çº§</strong></p>
<ul>
<li>ç¨‹åºè¿è¡Œå¼‚å¸¸</li>
<li>è¶…æ—¶</li>
<li>æœåŠ¡ç†”æ–­è§¦å‘æœåŠ¡é™çº§</li>
<li>çº¿ç¨‹æ± /ä¿¡å·é‡æ‰“æ»¡ä¹Ÿä¼šå¯¼è‡´æœåŠ¡é™çº§</li>
</ul>
<h3 id="æœåŠ¡ç†”æ–­"><a href="#æœåŠ¡ç†”æ–­" class="headerlink" title="æœåŠ¡ç†”æ–­"></a>æœåŠ¡ç†”æ–­</h3><p>break</p>
<p>æœåŠ¡ç†”æ–­å°±æ˜¯<strong>ä¿é™©ä¸</strong>ï¼Œå½“æœåŠ¡è¾¾åˆ°æœ€å¤§æœåŠ¡è®¿é—®æ—¶ï¼Œç›´æ¥æ‹’ç»è®¿é—®ï¼Œç„¶åè°ƒç”¨æœåŠ¡é™çº§çš„æ–¹æ³•è¿”å›å‹å¥½æç¤º</p>
<p>å¯ä»¥çœ‹å‡ºæœåŠ¡ç†”æ–­æ˜¯æ¯”æœåŠ¡é™çº§æ›´åŠ ä¸¥é‡çš„æªæ–½ã€‚</p>
<p>æœåŠ¡é™çº§&rightarrow;æœåŠ¡ç†”æ–­&rightarrow;æ¢å¤è°ƒç”¨é“¾è·¯</p>
<p>å¼€å§‹ä¼šä½¿ç”¨æœåŠ¡é™çº§æ¥å¤„ç†ï¼Œå¦‚æœè®¿é—®è¿‡å¤šå°±ä¼šè¿›è¡ŒæœåŠ¡ç†”æ–­æ“ä½œï¼Œå½“è®¿é—®ä¸¤æ¢å¤äº†æ­£å¸¸å€¼å°±æ¢å¤è°ƒç”¨é“¾è·¯ã€‚</p>
<h3 id="æœåŠ¡é™æµ"><a href="#æœåŠ¡é™æµ" class="headerlink" title="æœåŠ¡é™æµ"></a>æœåŠ¡é™æµ</h3><p>flowlimit</p>
<p>ç§’æ€ç­‰é«˜å¹¶å‘æ“ä½œï¼Œä¸¥ç¦ä¸€çªèœ‚æ‹¥æŒ¤è¿‡æ¥ï¼Œå¤§å®¶æ’é˜Ÿï¼Œæ¯ç§’çš„è®¿é—®é‡å›ºå®šï¼Œæœ‰åºè¿›è¡Œ</p>
<h2 id="Hystrixæ¡ˆä¾‹"><a href="#Hystrixæ¡ˆä¾‹" class="headerlink" title="Hystrixæ¡ˆä¾‹"></a>Hystrixæ¡ˆä¾‹</h2><h3 id="é¡¹ç›®æ„å»º"><a href="#é¡¹ç›®æ„å»º" class="headerlink" title="é¡¹ç›®æ„å»º"></a>é¡¹ç›®æ„å»º</h3><p><strong>1ã€å»ºmodule</strong></p>
<p>æ–°å»ºåä¸º<code>cloud-provider-hystrix-payment8001</code>çš„æ¨¡å—</p>
<p><strong>2ã€POM</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2020<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zxw.springcloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-provider-hystrix-payment8001<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot web--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--eureka client--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hystrix--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot devtools--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--cloud-api-commons--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zxw.springcloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>3ã€YML</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8001</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-provider-hystrix-payment</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka</span></span><br></pre></td></tr></table></figure>



<p><strong>4ã€ä¸»å¯åŠ¨</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentHystrixMain8001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(PaymentHystrixMain8001<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>5ã€ä¸šåŠ¡ç¼–å†™</strong></p>
<p><code>PaymentService</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ­£å¸¸è®¿é—®ï¼Œä¸ä¼šå‡ºç°é—®é¢˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"çº¿ç¨‹æ± : "</span> + Thread.currentThread().getName() + <span class="string">" paymentInfo_OK,id: "</span> + id + <span class="string">"\t"</span> + <span class="string">"ğŸ˜ğŸ˜ğŸ‘"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeout</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> timeInSeconds = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(timeInSeconds);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"çº¿ç¨‹æ± : "</span> + Thread.currentThread().getName() + <span class="string">" paymentInfo_timeout,id: "</span> + id + <span class="string">"\t"</span> + <span class="string">"è€—æ—¶"</span> + timeInSeconds + <span class="string">"ç§’é’Ÿ"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>PaymentController</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PaymentService paymentService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;server.port&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String serverPort;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/payment/hystrix/ok/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> paymentService.paymentInfo_OK(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/payment/hystrix/timeout/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeout</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> paymentService.paymentInfo_timeout(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>6ã€æµ‹è¯•</strong></p>
<ol>
<li><p>å¯åŠ¨<code>cloud-eureka-server7001</code></p>
</li>
<li><p>å¯åŠ¨<code>cloud-provider-hystrix-payment8001</code></p>
</li>
<li><p>è®¿é—®</p>
<ul>
<li><p><a href="http://localhost:8001/payment/hystrix/ok/1" target="_blank" rel="noopener">http://localhost:8001/payment/hystrix/ok/1</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201105220516170.png" alt="image-20201105220516170"></p>
</li>
<li><p><a href="http://localhost:8001/payment/hystrix/timeout/1" target="_blank" rel="noopener">http://localhost:8001/payment/hystrix/timeout/1</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201105220535163.png" alt="image-20201105220535163"></p>
</li>
</ul>
</li>
</ol>
<p>æµ‹è¯•æˆåŠŸä¹‹åå°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡å—æ¥æ¼”ç¤º</p>
<h3 id="é«˜å¹¶å‘æµ‹è¯•"><a href="#é«˜å¹¶å‘æµ‹è¯•" class="headerlink" title="é«˜å¹¶å‘æµ‹è¯•"></a>é«˜å¹¶å‘æµ‹è¯•</h3><p>ä¸Šé¢çš„æµ‹è¯•æ˜¯å»ºç«‹åœ¨éé«˜å¹¶å‘è®¿é—®çš„æƒ…å†µä¸‹ï¼Œæ‰€ä»¥è¿˜æ²¡æœ‰å‡ºç°é—®é¢˜ã€‚</p>
<h3 id="jmeterå‹åŠ›æµ‹è¯•"><a href="#jmeterå‹åŠ›æµ‹è¯•" class="headerlink" title="jmeterå‹åŠ›æµ‹è¯•"></a>jmeterå‹åŠ›æµ‹è¯•</h3><p>ä¸‹è½½jmeterï¼š<a href="https://jmeter.apache.org/download_jmeter.cgi" target="_blank" rel="noopener">https://jmeter.apache.org/download_jmeter.cgi</a></p>
<p>å¯åŠ¨jmeterï¼Œåœ¨æµ‹è¯•è®¡åˆ’ä¸­å…ˆå»ºç«‹çº¿ç¨‹ç»„ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106095809738.png" alt="image-20201106095809738"></p>
<p>åœ¨çº¿ç¨‹ç»„ä¸­å»ºç«‹HTTPè¯·æ±‚ï¼Œé…ç½®å¦‚ä¸‹ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201105223938197.png" alt="image-20201105223938197"></p>
<p>æ­¤æ—¶åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼š<a href="http://localhost/payment/hystrix/ok/1ï¼Œå’Œä¹‹å‰çš„æ­¤æ—¶ä¸åŒï¼Œè¿™æ¬¡éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆç­‰å¾…ã€å¡é¡¿ã€å»¶æ—¶ï¼‰æ‰èƒ½å¤Ÿå¾—åˆ°å“åº”" target="_blank" rel="noopener">http://localhost/payment/hystrix/ok/1ï¼Œå’Œä¹‹å‰çš„æ­¤æ—¶ä¸åŒï¼Œè¿™æ¬¡éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆç­‰å¾…ã€å¡é¡¿ã€å»¶æ—¶ï¼‰æ‰èƒ½å¤Ÿå¾—åˆ°å“åº”</a></p>
<p><strong>ç»“è®º</strong>ï¼šæ­¤å¤„çš„æµ‹è¿˜æ”¯æŒç›´æ¥è®¿é—®8001çš„ç»“æœï¼Œå¦‚æœæ˜¯æ¥è‡ªæ¶ˆè´¹è€…80ç«¯å£çš„è®¿é—®ï¼Œé‚£æ¶ˆè´¹è€…åªèƒ½ç­‰å¾…ç”šè‡³æŠ¥é”™ï¼</p>
<h4 id="åŠ å…¥æ¶ˆè´¹è€…è¿›è¡Œæµ‹è¯•"><a href="#åŠ å…¥æ¶ˆè´¹è€…è¿›è¡Œæµ‹è¯•" class="headerlink" title="åŠ å…¥æ¶ˆè´¹è€…è¿›è¡Œæµ‹è¯•"></a>åŠ å…¥æ¶ˆè´¹è€…è¿›è¡Œæµ‹è¯•</h4><p><strong>1ã€å»ºmodule</strong></p>
<p>æ–°å»ºåä¸º<code>cloud-consumer-feign-hystrix-order80</code>çš„æ¨¡å—</p>
<p><strong>2ã€æ”¹pom</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2020<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zxw.springcloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-consumer-feign-hystrix-order80<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot web--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--devtool--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--cloud-api-commons--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zxw.springcloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-api-commons<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;project.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--eureka client--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--open feign--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--spring cloud hystrix--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>3ã€YML</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-consumer-order</span></span><br></pre></td></tr></table></figure>



<p><strong>4ã€ä¸»é…ç½®</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHystrixMain80</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(OrderHystrixMain80<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>5ã€ä¸šåŠ¡ç±»</strong></p>
<p><code>PaymentHystrixService</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient</span>(<span class="string">"CLOUD-PROVIDER-HYSTRIX-PAYMENT"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PaymentHystrixService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/payment/hystrix/ok/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/payment/hystrix/timeout/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeout</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>OrderHystrixController</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHystrixController</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PaymentHystrixService paymentHystrixService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/consumer/payment/hystrix/ok/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">        String result = paymentHystrixService.paymentInfo_OK(id);</span><br><span class="line">        log.info(<span class="string">"result: "</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/consumer/payment/hystrix/timeout/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">payment_timeout</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">        String result = paymentHystrixService.paymentInfo_timeout(id);</span><br><span class="line">        log.info(<span class="string">"result: "</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•</strong></p>
<p>è®¿é—®ï¼š</p>
<ul>
<li><a href="http://localhost/consumer/payment/hystrix/ok/1ï¼Œè¿™ä¸ªå¯ä»¥æ­£å¸¸è®¿é—®" target="_blank" rel="noopener">http://localhost/consumer/payment/hystrix/ok/1ï¼Œè¿™ä¸ªå¯ä»¥æ­£å¸¸è®¿é—®</a></li>
<li><a href="http://localhost/consumer/payment/hystrix/timeout/1ï¼Œè¿™ä¸ªä¼šæŠ¥é”™ï¼Œå› ä¸ºfeignçš„è¶…æ—¶æ—¶é—´ä¸º1ç§’ï¼Œè¶…è¿‡äº†å°±ä¼šæŠ¥é”™" target="_blank" rel="noopener">http://localhost/consumer/payment/hystrix/timeout/1ï¼Œè¿™ä¸ªä¼šæŠ¥é”™ï¼Œå› ä¸ºfeignçš„è¶…æ—¶æ—¶é—´ä¸º1ç§’ï¼Œè¶…è¿‡äº†å°±ä¼šæŠ¥é”™</a></li>
</ul>
<p>åŒæ ·è¿›è¡Œjmeterè¿›è¡Œé«˜å¹¶å‘æµ‹è¯•ï¼Œç»“æœå°±æ˜¯</p>
<ul>
<li>å»¶æ—¶è¿”å›ç»“æœï¼ˆä¸æ–­è½¬åœˆï¼‰</li>
<li>å¦åˆ™å°±æ˜¯è¶…æ—¶æŠ¥é”™ï¼ˆç­‰å¾…æ—¶é—´å¤ªé•¿è¶…è¿‡äº†feignçš„è¶…æ—¶æ—¶é—´ï¼‰</li>
</ul>
<p>åŸå› ï¼štomcatæœåŠ¡å™¨ä¸­ä½¿ç”¨äº†çº¿ç¨‹æ± ï¼Œå½“çº¿ç¨‹æ± ä¸­çš„æ‰€æœ‰çº¿ç¨‹éƒ½è¢«ä½¿ç”¨æ—¶ï¼Œå…¶ä»–è¯·æ±‚å°±å¿…é¡»ç­‰å¾…</p>
<h4 id="å¦‚ä½•è§£å†³"><a href="#å¦‚ä½•è§£å†³" class="headerlink" title="å¦‚ä½•è§£å†³"></a>å¦‚ä½•è§£å†³</h4><p>æœåŠ¡æä¾›è€…ï¼ˆ8001ï¼‰è¶…æ—¶äº†ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼ˆ80ï¼‰ä¸èƒ½ä¸€ç›´ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§</p>
<p>æœåŠ¡æä¾›è€…ï¼ˆ8001ï¼‰å®•æœºäº†ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ï¼ˆ80ï¼‰ä¸èƒ½ä¸€ç›´ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§</p>
<p>æœåŠ¡æä¾›è€…ï¼ˆ8001ï¼‰æ²¡æœ‰é—®é¢˜ï¼ŒæœåŠ¡æ¶ˆè´¹è€…å‡ºç°æ•…éšœæˆ–è€…ç­‰å¾…æ—¶é—´å°äºæœåŠ¡æä¾›è€…ï¼Œè‡ªå·±ä¹Ÿè¦è¿›è¡ŒæœåŠ¡é™çº§</p>
<h3 id="æœåŠ¡é™çº§-1"><a href="#æœåŠ¡é™çº§-1" class="headerlink" title="æœåŠ¡é™çº§"></a>æœåŠ¡é™çº§</h3><p>é™çº§é…ç½®è¦ä½¿ç”¨@HystrixCommandæ³¨è§£</p>
<h4 id="æœåŠ¡æä¾›è€…æœåŠ¡é™çº§"><a href="#æœåŠ¡æä¾›è€…æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡æä¾›è€…æœåŠ¡é™çº§"></a>æœåŠ¡æä¾›è€…æœåŠ¡é™çº§</h4><p>ä¿®æ”¹<code>PaymentService</code></p>
<p>åœ¨è¦é…ç½®æœåŠ¡é™çº§çš„æ–¹æ³•ä¸Šä½¿ç”¨@HystrixCommandæ³¨è§£è¿›è¡Œé…ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ­£å¸¸è®¿é—®ï¼Œä¸ä¼šå‡ºç°é—®é¢˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"çº¿ç¨‹æ± : "</span> + Thread.currentThread().getName() + <span class="string">" paymentInfo_OK,id: "</span> + id + <span class="string">"\t"</span> + <span class="string">"ğŸ˜ğŸ˜ğŸ‘"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@HystrixCommand</span>(fallbackMethod = <span class="string">"paymentInfo_timeoutHandler"</span>, commandProperties = &#123;</span><br><span class="line">            <span class="comment">//3ç§’ä»¥å†…å°±æ‰§è¡Œæ­£å¸¸ä¸šåŠ¡é€»è¾‘ï¼Œå¦åˆ™è°ƒç”¨fallbackMethodæŒ‡å®šçš„æ–¹æ³•</span></span><br><span class="line">            <span class="meta">@HystrixProperty</span>(name = <span class="string">"execution.isolation.thread.timeoutInMilliseconds"</span>, value = <span class="string">"3000"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeout</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> timeInSeconds = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(timeInSeconds);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"çº¿ç¨‹æ± : "</span> + Thread.currentThread().getName() + <span class="string">" paymentInfo_timeout,id: "</span> + id + <span class="string">"\t"</span> + <span class="string">"è€—æ—¶"</span> + timeInSeconds + <span class="string">"ç§’é’Ÿ"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeoutHandler</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"çº¿ç¨‹æ± : "</span> + Thread.currentThread().getName() + <span class="string">" ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼id:"</span> + id + <span class="string">"\tğŸ˜¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableCircuitBreakeræ³¨è§£</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@EnableCircuitBreaker</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentHystrixMain8001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(PaymentHystrixMain8001<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•</strong>ï¼šè®¿é—®<a href="http://localhost:8001/payment/hystrix/timeout/1" target="_blank" rel="noopener">http://localhost:8001/payment/hystrix/timeout/1</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106164443636.png" alt="image-20201106164443636"></p>
<p>ç”±äº<code>paymentInfo_timeout</code>æ–¹æ³•ä¼šä¼‘çœ 5ç§’ï¼Œè¶…è¿‡äº†@HystrixCommandä¸­é…ç½®çš„3ç§’çš„è¶…æ—¶æ—¶é—´ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨fallbackMethodæŒ‡å®šçš„æ–¹æ³•<code>paymentInfo_timeoutHandler</code>ï¼ˆå‚æ•°å’Œ<code>paymentInfo_timeout</code>ç›¸åŒï¼‰</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106170707152.png" alt="image-20201106170707152"></p>
<p>æ³¨æ„ï¼šè¿™é‡Œçš„çº¿ç¨‹åç§°æ˜¯HystrixTimerï¼Œä½¿ç”¨çš„æ˜¯Hystrixçš„è¶…æ—¶çº¿ç¨‹æ± ï¼›å¦‚æœçº¿ç¨‹åæ˜¯<code>hystrix-PaymentService</code>ï¼Œåˆ™è¯´æ˜æ˜¯ä¸šåŠ¡æ–¹æ³•å†…éƒ¨å‘ç”Ÿäº†é”™è¯¯ï¼</p>
<p>åªè¦æ˜¯å½“å‰æœåŠ¡ä¸å¯ç”¨äº†ï¼Œå°±ä¼šè°ƒç”¨æœåŠ¡é™çº§æ¥å…œåº•ï¼ä¹Ÿå°±æ˜¯è°ƒç”¨<code>paymentInfo_timeoutHandler</code>æ–¹æ³•</p>
<h4 id="æœåŠ¡æ¶ˆè´¹è€…æœåŠ¡é™çº§"><a href="#æœåŠ¡æ¶ˆè´¹è€…æœåŠ¡é™çº§" class="headerlink" title="æœåŠ¡æ¶ˆè´¹è€…æœåŠ¡é™çº§"></a>æœåŠ¡æ¶ˆè´¹è€…æœåŠ¡é™çº§</h4><p>åŒç†ä¹Ÿå¯ä»¥å¯¹æœåŠ¡æ¶ˆè´¹è€…è¿›è¡ŒæœåŠ¡é™çº§ï¼ˆå‚ç…§æœåŠ¡æä¾›è€…çš„æœåŠ¡é™çº§ï¼‰</p>
<p><strong>ymlé…ç½®</strong></p>
<p>å¼€å¯feignçš„hystrixçš„æ”¯æŒ</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p><strong>ä¸»å¯åŠ¨ç±»</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="meta">@EnableHystrix</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHystrixMain80</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(OrderHystrixMain80<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¿®æ”¹<code>OrderHystrixController</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/consumer/payment/hystrix/timeout/&#123;id&#125;"</span>)</span><br><span class="line"><span class="meta">@HystrixCommand</span>(fallbackMethod = <span class="string">"paymentInfo_timeoutHandler"</span>, commandProperties = &#123;</span><br><span class="line">    <span class="comment">//3ç§’ä»¥å†…å°±æ‰§è¡Œæ­£å¸¸ä¸šåŠ¡é€»è¾‘ï¼Œå¦åˆ™è°ƒç”¨fallbackMethodæŒ‡å®šçš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@HystrixProperty</span>(name = <span class="string">"execution.isolation.thread.timeoutInMilliseconds"</span>, value = <span class="string">"3000"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">payment_timeout</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">    String result = paymentHystrixService.paymentInfo_timeout(id);</span><br><span class="line">    log.info(<span class="string">"result: "</span> + result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeoutHandler</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"çº¿ç¨‹æ± : "</span> + Thread.currentThread().getName() + <span class="string">" 80ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åå†è¯•ï¼id:"</span> + id + <span class="string">"\tğŸ˜¼"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>æµ‹è¯•</strong>ï¼š</p>
<p>1ã€ç­‰å¾…æœåŠ¡æä¾›è€…è¿”å›ç»“æœè¶…æ—¶</p>
<p>è®¿é—®ï¼š<a href="http://localhost/consumer/payment/hystrix/timeout/1" target="_blank" rel="noopener">http://localhost/consumer/payment/hystrix/timeout/1</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106173158726.png" alt="image-20201106173158726"></p>
<p>å‡ºç°è¿™ä¸ªç»“æœæ˜¯å› ä¸ºï¼Œè°ƒç”¨æœåŠ¡æä¾›è€…çš„æœåŠ¡çš„æ—¶å€™è¶…è¿‡3ç§’ä¼šæ‰§è¡ŒæœåŠ¡æä¾›è€…çš„æœåŠ¡é™çº§ï¼Œä½†æ˜¯feigné»˜è®¤1ç§’å°±è¶…æ—¶äº†ï¼Œæ‰€ä»¥ä¼šæŠ¥é”™ï¼Œä½†æ˜¯æœåŠ¡æ¶ˆè´¹è€…ä¹Ÿæä¾›äº†æœåŠ¡é™çº§ï¼Œæ‰€ä»¥ä¼šæ‰§è¡ŒæœåŠ¡æ¶ˆè´¹è€…çš„æœåŠ¡é™çº§æ–¹æ³•ã€‚</p>
<p>2ã€æœåŠ¡æ¶ˆè´¹è€…æœ¬èº«è¶…æ—¶</p>
<p>ä¿®æ”¹controllerä¸­çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/consumer/payment/hystrix/timeout/&#123;id&#125;"</span>)</span><br><span class="line"><span class="meta">@HystrixCommand</span>(fallbackMethod = <span class="string">"paymentInfo_timeoutHandler"</span>, commandProperties = &#123;</span><br><span class="line">    <span class="comment">//3ç§’ä»¥å†…å°±æ‰§è¡Œæ­£å¸¸ä¸šåŠ¡é€»è¾‘ï¼Œå¦åˆ™è°ƒç”¨fallbackMethodæŒ‡å®šçš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@HystrixProperty</span>(name = <span class="string">"execution.isolation.thread.timeoutInMilliseconds"</span>, value = <span class="string">"3000"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">payment_timeout</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> timeInSeconds = <span class="number">5</span>;</span><br><span class="line">    <span class="comment">//ä¼‘çœ 5ç§’</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(timeInSeconds);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    String result = paymentHystrixService.paymentInfo_timeout(id);</span><br><span class="line">    log.info(<span class="string">"result: "</span> + result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶è®¿é—®<a href="http://localhost/consumer/payment/hystrix/timeout/1ï¼Œç»“æœå¦‚ä¸‹ï¼š" target="_blank" rel="noopener">http://localhost/consumer/payment/hystrix/timeout/1ï¼Œç»“æœå¦‚ä¸‹ï¼š</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106173649794.png" alt="image-20201106173649794"></p>
<p>æ­¤æ—¶ç”±äºæœåŠ¡æ¶ˆè´¹è€…ä¸­çš„æ–¹æ³•ä¼‘çœ å¯¼è‡´æ–¹æ³•çš„æ‰§è¡Œæ—¶é—´è¶…è¿‡äº†@HystrixCommandä¸­æŒ‡å®šçš„è¶…æ—¶æ—¶é—´ï¼Œæ‰€ä»¥è°ƒç”¨äº†fallbackMethodæŒ‡å®šçš„æ–¹æ³•</p>
<p>3ã€æœåŠ¡æ¶ˆè´¹è€…å‘ç”Ÿé”™è¯¯</p>
<p>ä¿®æ”¹controllerä¸­çš„æ–¹æ³•</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/consumer/payment/hystrix/timeout/&#123;id&#125;"</span>)</span><br><span class="line"><span class="meta">@HystrixCommand</span>(fallbackMethod = <span class="string">"paymentInfo_timeoutHandler"</span>, commandProperties = &#123;</span><br><span class="line">    <span class="comment">//3ç§’ä»¥å†…å°±æ‰§è¡Œæ­£å¸¸ä¸šåŠ¡é€»è¾‘ï¼Œå¦åˆ™è°ƒç”¨fallbackMethodæŒ‡å®šçš„æ–¹æ³•</span></span><br><span class="line">    <span class="meta">@HystrixProperty</span>(name = <span class="string">"execution.isolation.thread.timeoutInMilliseconds"</span>, value = <span class="string">"3000"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">payment_timeout</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">    <span class="comment">//è®¤ä¸ºåˆ¶é€ ä¸€ä¸ªå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">10</span> / <span class="number">0</span>;</span><br><span class="line">    String result = paymentHystrixService.paymentInfo_timeout(id);</span><br><span class="line">    log.info(<span class="string">"result: "</span> + result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†æ¬¡è®¿é—®ç»“æœå¦‚ä¸‹:</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106173905815.png" alt="image-20201106173905815"></p>
<p>æ­¤æ—¶ç”±äºæœåŠ¡æ¶ˆè´¹è€…å†…éƒ¨å‘ç”Ÿäº†å¼‚å¸¸ä»è€Œè°ƒç”¨äº†fallbackMethodæŒ‡å®šçš„æ–¹æ³•ï¼</p>
<h4 id="ç›®å‰çš„é—®é¢˜"><a href="#ç›®å‰çš„é—®é¢˜" class="headerlink" title="ç›®å‰çš„é—®é¢˜"></a>ç›®å‰çš„é—®é¢˜</h4><p>1ã€<strong>ä»£ç è€¦åˆ</strong>ï¼Œä¸šåŠ¡æ–¹æ³•å’Œå…œåº•æ–¹æ³•éƒ½æ”¾åœ¨ä¸€ä¸ªç±»ä¸­ä¼šå¯¼è‡´ä»£ç è€¦åˆï¼</p>
<p>2ã€<strong>ä»£ç è†¨èƒ€</strong>ï¼Œæ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•éƒ½éœ€è¦ä¸€ä¸ªå…œåº•æ–¹æ³•ï¼</p>
<h4 id="è§£å†³é—®é¢˜"><a href="#è§£å†³é—®é¢˜" class="headerlink" title="è§£å†³é—®é¢˜"></a>è§£å†³é—®é¢˜</h4><p><strong>è§£å†³ä»£ç è†¨èƒ€é—®é¢˜</strong></p>
<p>å¯ä»¥ä½¿ç”¨<code>@DefaultProperties(defaultFallback = â€œâ€)</code>æ¥è§£å†³ï¼Œå³æä¾›ä¸€ä¸ªé»˜è®¤çš„å…œåº•æ–¹æ³•ï¼ˆé’ˆå¯¹æ²¡æœ‰é…ç½®å…œåº•æ–¹æ³•çš„æ¥è¯´ï¼‰ï¼Œå¦‚æœä½¿ç”¨@HystrixCommandçš„fallbackMethodå±æ€§æ³¨è§£æŒ‡å®šäº†å…œåº•æ–¹æ³•ï¼Œåˆ™ä½¿ç”¨æŒ‡å®šçš„æ–¹æ³•æ¥å®ç°æœåŠ¡é™çº§ï¼›å¦‚æœä½¿ç”¨äº†@HsytrixCommandæ³¨è§£ä½†æ˜¯æ²¡æœ‰æŒ‡å®šfallbackMethodå±æ€§æŒ‡å®šï¼Œåˆ™ä½¿ç”¨é»˜è®¤çš„å…œåº•æ–¹æ³•ï¼</p>
<p><strong>ç¤ºä¾‹</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="meta">@DefaultProperties</span>(defaultFallback = <span class="string">"defaultHandler"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHystrixController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PaymentHystrixService paymentHystrixService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/consumer/payment/hystrix/ok/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="meta">@HystrixCommand</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">10</span> / <span class="number">0</span>;</span><br><span class="line">        String result = paymentHystrixService.paymentInfo_OK(id);</span><br><span class="line">        log.info(<span class="string">"result: "</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">defaultHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"çº¿ç¨‹æ± : "</span> + Thread.currentThread().getName() + <span class="string">" é»˜è®¤çš„å…œåº•æ–¹æ³•ï¼"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­¤æ—¶è®¿é—®<a href="http://localhost/consumer/payment/hystrix/ok/1ï¼Œç»“æœå¦‚ä¸‹" target="_blank" rel="noopener">http://localhost/consumer/payment/hystrix/ok/1ï¼Œç»“æœå¦‚ä¸‹</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106175310708.png" alt="image-20201106175310708"></p>
<p><strong>è§£å†³ä»£ç è€¦åˆé—®é¢˜</strong></p>
<p>ä»£ç è€¦åˆçš„é—®é¢˜ï¼Œåªéœ€è¦æä¾›ä¸€ä¸ª@FeignClientæ³¨è§£æ ‡æ³¨çš„æ¥å£çš„å®ç°ç±»ï¼Œç„¶åå†@FeignClientçš„fallbackå±æ€§ä¸ºè¿™ä¸ªå®ç°ç±»å³å¯ã€‚</p>
<p><code>PaymentHystrixService</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient</span>(value = <span class="string">"CLOUD-PROVIDER-HYSTRIX-PAYMENT"</span>, fallback = PaymentFallbackService<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">interface</span> <span class="title">PaymentHystrixService</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/payment/hystrix/ok/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/payment/hystrix/timeout/&#123;id&#125;"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeout</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>PaymentFallbackService</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentFallbackService</span> <span class="keyword">implements</span> <span class="title">PaymentHystrixService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"paymentInfo_OK"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_timeout</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"paymentInfo_timeout"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœæ­¢æœåŠ¡æä¾›è€…8001ï¼Œç„¶åè®¿é—®<a href="http://localhost/consumer/payment/hystrix/ok/1å’Œhttp://localhost/consumer/payment/hystrix/timeout/1" target="_blank" rel="noopener">http://localhost/consumer/payment/hystrix/ok/1å’Œhttp://localhost/consumer/payment/hystrix/timeout/1</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106201112941.png" alt="image-20201106201112941"></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201106201135023.png" alt="image-20201106201135023"></p>
<p>è¿™æ ·å°±å®ç°äº†æœåŠ¡æ–¹æ³•å’ŒæœåŠ¡é™çº§æ–¹æ³•çš„åˆ†ç¦»</p>
<h3 id="æœåŠ¡ç†”æ–­-1"><a href="#æœåŠ¡ç†”æ–­-1" class="headerlink" title="æœåŠ¡ç†”æ–­"></a>æœåŠ¡ç†”æ–­</h3><h4 id="æœåŠ¡ç†”æ–­æ˜¯ä»€ä¹ˆ"><a href="#æœåŠ¡ç†”æ–­æ˜¯ä»€ä¹ˆ" class="headerlink" title="æœåŠ¡ç†”æ–­æ˜¯ä»€ä¹ˆ"></a>æœåŠ¡ç†”æ–­æ˜¯ä»€ä¹ˆ</h4><p>ç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶ã€‚å½“æ‰‡å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡å‡ºé”™ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§ï¼Œè¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨ï¼Œå¿«é€Ÿè¿”å›é”™è¯¯çš„å“åº”ä¿¡æ¯ã€‚</p>
<p><strong>å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹çš„å¾®æœåŠ¡è°ƒç”¨å“åº”æ­£å¸¸åï¼Œæ¢å¤è°ƒç”¨é“¾è·¯</strong></p>
<p>åœ¨Spring Cloudæ¡†æ¶é‡Œï¼Œç†”æ–­æœºåˆ¶é€šè¿‡Hystrixå®ç°ã€‚Hystrixä¼šç›‘æ§å¾®æœåŠ¡é—´è°ƒç”¨çš„çŠ¶å†µï¼Œå½“å¤±è´¥çš„è°ƒç”¨åˆ°ä¸€å®šé˜ˆå€¼ï¼Œç¼ºçœæ˜¯5ç§’å†…20æ¬¡è°ƒç”¨å¤±è´¥ï¼Œå°±ä¼šå¯åŠ¨ç†”æ–­æœºåˆ¶ã€‚ç†”æ–­æœºåˆ¶çš„æ³¨è§£æ˜¯@HystrixCommand</p>
<p>ç†Ÿæ‚‰çš„å¤§ç¥Martin Fowlerçš„è®ºæ–‡ï¼š<a href="https://martinfowler.com/bliki/CircuitBreaker.html" target="_blank" rel="noopener">https://martinfowler.com/bliki/CircuitBreaker.html</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108160044903.png" alt="image-20201108160044903"></p>
<p>æ–­è·¯å™¨æœ‰ä¸‰ç§çŠ¶æ€</p>
<ul>
<li>å¼€</li>
<li>å…³</li>
<li>åŠå¼€</li>
</ul>
<p>å°†è®¾æ–­è·¯å™¨èƒ½å¤Ÿæ¥æ”¶çš„è®¿é—®é‡æ˜¯æ¯ç§’100æ¬¡</p>
<p>å¦‚æœæ¯ç§’çš„è®¿é—®é‡å°äº100æ¬¡ï¼Œé‚£ä¹ˆæ–­è·¯å™¨å¤„äºå…³é—­çŠ¶æ€ï¼ŒæœåŠ¡èƒ½å¤Ÿæ­£å¸¸è®¿é—®</p>
<p>æ­¤æ—¶ï¼Œå¦‚æœæ¯ç§’çš„è®¿é—®é‡çªç„¶æ¿€å¢åˆ°äº†æ¯ç§’500æ¬¡ï¼Œæ–­è·¯å™¨è§‰å¾—è¶…è¿‡äº†é˜ˆå€¼ï¼Œæ‰€ä»¥å°±æ‰“å¼€äº†ï¼ŒæœåŠ¡ä¹Ÿå°±ä¸èƒ½å¤Ÿè®¿é—®äº†</p>
<p>ä½†æ˜¯ï¼Œæ–­è·¯å™¨ä¸èƒ½ä¸€ç›´å¼€ç€ï¼Œä¸ç„¶æœåŠ¡å°±æ²¡æ³•è®¿é—®äº†ï¼Œæ‰€ä»¥æ–­è·¯å™¨æ˜¯è¿›å…¥äº†åŠå¼€çŠ¶æ€ï¼ˆä¸€ç§å—ä¿æŠ¤çš„è°ƒç”¨çŠ¶æ€ï¼‰ï¼Œå¦‚æœè®¿é—®é‡æ¢å¤äº†æ­£å¸¸ï¼Œé‚£ä¹ˆæ–­è·¯å™¨å°±ä¼šå…³é—­ï¼Œæ­¤æ—¶è°ƒç”¨é“¾è·¯ä¹Ÿå°±æ¢å¤äº†ã€‚</p>
<h4 id="å®æˆ˜"><a href="#å®æˆ˜" class="headerlink" title="å®æˆ˜"></a>å®æˆ˜</h4><p>å…‰è¯´ä¸ç»ƒå‡æŠŠå¼ï¼Œä¸‹é¢å°±å†™ä¸€ä¸ªHystrixæœåŠ¡ç†”æ–­çš„ç¤ºä¾‹</p>
<p>ä¿®æ”¹<code>cloud-provider-hystrix-payment8001</code>çš„<code>PaymentService</code>ï¼Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HystrixCommand</span>(fallbackMethod = <span class="string">"paymentCircuitBreaker_fallback"</span>, commandProperties = &#123;</span><br><span class="line">    <span class="comment">//å¼€å¯æ–­è·¯å™¨</span></span><br><span class="line">    <span class="meta">@HystrixProperty</span>(name = <span class="string">"circuitBreaker.enabled"</span>, value = <span class="string">"true"</span>),</span><br><span class="line">    <span class="comment">//è¯·æ±‚æ¬¡æ•°</span></span><br><span class="line">    <span class="meta">@HystrixProperty</span>(name = <span class="string">"circuitBreaker.requestVolumeThreshold"</span>, value = <span class="string">"10"</span>),</span><br><span class="line">    <span class="comment">//æ—¶é—´çª—å£æœŸ</span></span><br><span class="line">    <span class="meta">@HystrixProperty</span>(name = <span class="string">"circuitBreaker.sleepWindowInMilliseconds"</span>, value = <span class="string">"10000"</span>),</span><br><span class="line">    <span class="comment">//å¤±è´¥ç‡è¾¾åˆ°å¤šå°‘åè·³é—¸</span></span><br><span class="line">    <span class="meta">@HystrixProperty</span>(name = <span class="string">"circuitBreaker.errorThresholdPercentage"</span>, value = <span class="string">"60"</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentCircuitBreaker</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (id &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"idä¸èƒ½ä¸ºè´Ÿæ•°ï¼"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    String serialNumber = IdUtil.simpleUUID();</span><br><span class="line">    <span class="keyword">return</span> Thread.currentThread().getName() + <span class="string">"\t"</span> + <span class="string">"è°ƒç”¨æˆåŠŸ, æµæ°´å·:"</span> + serialNumber;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentCircuitBreaker_fallback</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"id ä¸èƒ½ä¸ºè´Ÿæ•°ï¼Œè¯·ç¨åå†è¯•(ï¿£â–½ï¿£)~~ id:"</span> + id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ®µçš„é…ç½®ï¼Œå°±æ˜¯åœ¨è¯·æ±‚10æ¬¡å¦‚æœæœ‰6æ¬¡å¤±è´¥äº†ï¼Œæ–­è·¯å™¨å°±è·³é—¸ã€‚è¿‡äº†çª—å£æœŸæ—¶é—´10sä¹‹åä¼šè¿›å…¥half opençŠ¶æ€</p>
<p>@HystrixCommandèƒ½é…ç½®å“ªäº›å†…å®¹å¯ä»¥å‚è€ƒè¿™ç¯‡åšå®¢ï¼š<a href="https://blog.csdn.net/u010395804/article/details/80266335" target="_blank" rel="noopener">https://blog.csdn.net/u010395804/article/details/80266335</a></p>
<p>ä¹Ÿå¯ä»¥å‚è€ƒ<code>HystrixCommandProperties</code>è¿™ä¸ªå±æ€§ç±»</p>
<p><code>PaymentController</code>æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span>(<span class="string">"/payment/circuit/&#123;id&#125;"</span>)</span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentCircuitBreaker</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) </span>&#123;</span><br><span class="line">    String result = paymentService.paymentCircuitBreaker(id);</span><br><span class="line">    log.info(<span class="string">"result:"</span> + result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>æµ‹è¯•</strong>ï¼š</p>
<p>æ­£å¸¸æµ‹è¯•ï¼š<a href="http://localhost:8001/payment/circuit/1ï¼Œç»“æœå¦‚ä¸‹ï¼š" target="_blank" rel="noopener">http://localhost:8001/payment/circuit/1ï¼Œç»“æœå¦‚ä¸‹ï¼š</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108164816391.png" alt="image-20201108164816391"></p>
<p>è®¿é—®è´Ÿæ•°idï¼š<a href="http://localhost:8001/payment/circuit/-1ï¼Œç»“æœå¦‚ä¸‹ï¼š" target="_blank" rel="noopener">http://localhost:8001/payment/circuit/-1ï¼Œç»“æœå¦‚ä¸‹ï¼š</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108164905477.png" alt="image-20201108164905477"></p>
<p>ç–¯ç‹‚åˆ·æ–°ï¼Œä¿è¯10å†…ä»¥è´Ÿæ•°idè®¿é—®çš„æ¬¡æ•°è¶…è¿‡10æ¬¡ï¼Œç„¶åä»¥æ­£å¸¸idè®¿é—®ï¼š<a href="http://localhost:8001/payment/circuit/1" target="_blank" rel="noopener">http://localhost:8001/payment/circuit/1</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108165028000.png" alt="image-20201108165028000"></p>
<p>ç»“æœå‘ç°ï¼Œç°åœ¨è¿æ­£å¸¸çš„idè®¿é—®éƒ½ä¼šè°ƒç”¨fallbackæ–¹æ³•ï¼Œè¿™è¯´æ˜æœåŠ¡ç†”æ–­è¢«è§¦å‘äº†</p>
<p>è¿‡ä¸€æ®µæ—¶é—´ï¼Œå†æ¬¡ä»¥æ­£å¸¸idè®¿é—®ï¼š<a href="http://localhost:8001/payment/circuit/1" target="_blank" rel="noopener">http://localhost:8001/payment/circuit/1</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108165146753.png" alt="image-20201108165146753"></p>
<p>ç»“æœå‘ç°æœåŠ¡åˆå¯ä»¥æ­£å¸¸è®¿é—®äº†</p>
<h4 id="ç†”æ–­ç±»å‹"><a href="#ç†”æ–­ç±»å‹" class="headerlink" title="ç†”æ–­ç±»å‹"></a>ç†”æ–­ç±»å‹</h4><ul>
<li><strong>ç†”æ–­æ‰“å¼€</strong>ï¼šè¯·æ±‚ä¸å†è°ƒç”¨å½“å‰æœåŠ¡ï¼Œå†…éƒ¨è®¾ç½®æ—¶é’Ÿä¸€èˆ¬ä¸ºMTTRï¼ˆå¹³å‡æ•…éšœå¤„ç†æ—¶é—´ï¼‰ï¼Œå½“æ‰“å¼€æ—¶é•¿è¾¾åˆ°æ‰€è®¾æ—¶é’Ÿåˆ™è¿›å…¥åŠç†”æ–­çŠ¶æ€</li>
<li><strong>ç†”æ–­å…³é—­</strong>ï¼šä¸ä¼šå¯¹æœåŠ¡è¿›è¡Œç†”æ–­</li>
<li><strong>ç†”æ–­åŠå¼€</strong>ï¼šéƒ¨åˆ†è¯·æ±‚æ ¹æ®è§„åˆ™è°ƒç”¨å½“å‰æœåŠ¡ï¼Œå¦‚æœè¯·æ±‚æˆåŠŸä¸”ç¬¦åˆè§„åˆ™åˆ™è®¤ä¸ºå½“å‰æœåŠ¡æ¢å¤æ­£å¸¸ï¼Œå…³é—­ç†”æ–­</li>
</ul>
<h4 id="å®˜ç½‘æ–­è·¯å™¨æµç¨‹"><a href="#å®˜ç½‘æ–­è·¯å™¨æµç¨‹" class="headerlink" title="å®˜ç½‘æ–­è·¯å™¨æµç¨‹"></a>å®˜ç½‘æ–­è·¯å™¨æµç¨‹</h4><p><strong>æ¶‰åŠæ–­è·¯å™¨çš„é‡è¦å‚æ•°</strong>ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108180044826.png" alt="image-20201108180044826"></p>
<ul>
<li><p><strong>circuitBreaker é…ç½®</strong></p>
<p>è¯¥é…ç½®å‰ç¼€ä¸º <strong>hystrix.command.default</strong></p>
<ul>
<li><strong>circuitBreaker.enabled</strong>ï¼šè¯¥å±æ€§ç”¨æ¥ç¡®å®šå½“æœåŠ¡è¯·æ±‚å‘½ä»¤å¤±è´¥æ—¶ï¼Œæ˜¯å¦ä½¿ç”¨æ–­è·¯å™¨æ¥è·Ÿè¸ªå…¶å¥åº·æŒ‡æ ‡å’Œç†”æ–­è¯·æ±‚ï¼Œé»˜è®¤å€¼ true</li>
<li><strong>circuitBreaker.requestVolumeThreshold</strong>ï¼šè¯¥å±æ€§ç”¨æ¥è®¾ç½®åœ¨æ»šåŠ¨æ—¶é—´çª—ä¸­ï¼Œæ–­è·¯å™¨çš„æœ€å°è¯·æ±‚æ•°ã€‚ä¾‹å¦‚ï¼šé»˜è®¤å€¼ 20 çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ»šåŠ¨æ—¶é—´çª—ï¼ˆé»˜è®¤å€¼ 10ç§’ï¼‰å†…ä»…æ”¶åˆ°19ä¸ªè¯·æ±‚ï¼Œå³ä½¿è¿™19ä¸ªè¯·æ±‚éƒ½å¤±è´¥äº†ï¼Œæ–­è·¯å™¨ä¹Ÿä¸ä¼šæ‰“å¼€ã€‚</li>
<li><strong>circuitBreaker.sleepWindowInMilliseconds</strong>ï¼šè¯¥å±æ€§ç”¨æ¥è®¾ç½®å½“æ–­è·¯å™¨æ‰“å¼€ä¹‹åçš„ä¼‘çœ æ—¶é—´çª—ã€‚é»˜è®¤å€¼ 5000 æ¯«ç§’ï¼Œä¼‘çœ æ—¶é—´çª—ç»“æŸä¹‹åï¼Œä¼šå°†æ–­è·¯å™¨è®¾ç½®ä¸ºâ€åŠå¼€â€çŠ¶æ€ï¼Œå°è¯•ç†”æ–­çš„è¯·æ±‚å‘½ä»¤ï¼Œå¦‚æœä¾ç„¶å¤±è´¥å°±å°†æ–­è·¯å™¨ç»§ç»­è®¾ç½®ä¸ºâ€æ‰“å¼€â€çŠ¶æ€ï¼Œå¦‚æœæˆåŠŸå°±è®¾ç½®ä¸ºâ€å…³é—­â€çŠ¶æ€ã€‚</li>
<li><strong>circuitBreaker.errorThresholdPercentage</strong>ï¼šè¯¥å±æ€§ç”¨æ¥è®¾ç½®æ–­è·¯å™¨æ‰“å¼€çš„é”™è¯¯ç™¾åˆ†æ¯”æ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œé»˜è®¤å€¼ä¸º 50 çš„æƒ…å†µä¸‹ï¼Œè¡¨ç¤ºåœ¨æ»šåŠ¨æ—¶é—´çª—ä¸­ï¼Œåœ¨è¯·æ±‚æ•°é‡è¶…è¿‡ circuitBreaker.requestVolumeThreshold é˜ˆå€¼çš„è¯·æ±‚ä¸‹ï¼Œå¦‚æœé”™è¯¯è¯·æ±‚æ•°çš„ç™¾åˆ†æ¯”è¶…è¿‡50ï¼Œå°±æŠŠæ–­è·¯å™¨è®¾ç½®ä¸ºâ€æ‰“å¼€â€çŠ¶æ€ï¼Œå¦åˆ™å°±è®¾ç½®ä¸ºâ€å…³é—­â€çŠ¶æ€ã€‚</li>
<li><strong>circuitBreaker.forceOpen</strong>ï¼šè¯¥å±æ€§ç”¨æ¥è®¾ç½®æ–­è·¯å™¨å¼ºåˆ¶è¿›å…¥â€æ‰“å¼€â€çŠ¶æ€ï¼Œä¼šæ‹’ç»æ‰€æœ‰è¯·æ±‚ï¼Œè¯¥å±æ€§ä¼˜å…ˆäº circuitBreaker.forceClosed</li>
<li><strong>circuitBreaker.forceClosed</strong>ï¼šè¯¥å±æ€§ç”¨æ¥è®¾ç½®æ–­è·¯å™¨å¼ºåˆ¶è¿›å…¥â€å…³é—­â€çŠ¶æ€ï¼Œä¼šæ¥æ”¶æ‰€æœ‰è¯·æ±‚ã€‚</li>
</ul>
</li>
</ul>
<h2 id="æœåŠ¡ç›‘æ§hystrixDashboard"><a href="#æœåŠ¡ç›‘æ§hystrixDashboard" class="headerlink" title="æœåŠ¡ç›‘æ§hystrixDashboard"></a>æœåŠ¡ç›‘æ§hystrixDashboard</h2><p>é™¤äº†éš”ç¦»ä¾èµ–æœåŠ¡çš„è°ƒç”¨å¤–ï¼ŒHystrixè¿˜æä¾›äº†<strong>å‡†å®æ—¶çš„è°ƒç”¨ç›‘æ§ï¼ˆHystrix Dashboardï¼‰</strong>ï¼ŒHystrixä¼šæŒç»­åœ°è®°å½•æ‰€æœ‰é€šè¿‡Hystrixå‘èµ·çš„è¯·æ±‚çš„æ‰§è¡Œä¿¡æ¯ï¼Œå¹¶ä»¥ç»Ÿè®¡æŠ¥è¡¨å’Œå›¾å½¢çš„å½¢å¼å±•ç¤ºç»™ç”¨æˆ·ï¼ŒåŒ…æ‹¬æ¯ç§’æ‰§è¡Œå¤šå°‘è¯·æ±‚ã€å¤šå°‘æˆåŠŸã€å¤šå°‘å¤±è´¥ç­‰ã€‚Netflixé€šè¿‡<code>hystrix-metrics-event-stream</code>é¡¹ç›®å®ç°äº†å¯¹ä»¥ä¸ŠæŒ‡æ ‡çš„ç›‘æ§ã€‚Spring Cloudä¹Ÿæä¾›äº†Hystrix Dashboardçš„æ•´åˆï¼Œå°†ç›‘æ§å†…å®¹è½¬æ¢ä¸ºå¯è§†åŒ–ç•Œé¢ã€‚</p>
<h3 id="ä½¿ç”¨ç¤ºä¾‹"><a href="#ä½¿ç”¨ç¤ºä¾‹" class="headerlink" title="ä½¿ç”¨ç¤ºä¾‹"></a>ä½¿ç”¨ç¤ºä¾‹</h3><p><strong>1ã€å»ºmodule</strong></p>
<p>å»ºç«‹åä¸º<code>cloud-consumer-hystrix-dashboard9001</code>æ¨¡å—</p>
<p><strong>2ã€pom</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">"http://maven.apache.org/POM/4.0.0"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud2020<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.zxw.springcloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>cloud-consumer-hystrix-dashboard9001<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--hystrix dashboard--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-netflix-hystrix-dashboard<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--actuator--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--devtools--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--lombok--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--springboot test--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p><strong>3ã€yml</strong></p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9001</span></span><br><span class="line"></span><br><span class="line"><span class="attr">hystrix:</span></span><br><span class="line">  <span class="attr">dashboard:</span></span><br><span class="line">  	<span class="comment">#å…è®¸localhost</span></span><br><span class="line">    <span class="attr">proxy-stream-allow-list:</span> <span class="string">"localhost"</span></span><br></pre></td></tr></table></figure>



<p><strong>4ã€ä¸»é…ç½®</strong></p>
<p>ä½¿ç”¨@EnableHystrixDashboardå¼€å¯Hystrix Dashboard</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableHystrixDashboard</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HystrixDashboardMain9001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(HystrixDashboardMain9001<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><strong>æµ‹è¯•</strong></p>
<p>è®¿é—®<a href="http://localhost:9001/hystrixï¼Œå‡ºç°ä¸‹é¢çš„ç•Œé¢è¯´æ˜æˆåŠŸï¼š" target="_blank" rel="noopener">http://localhost:9001/hystrixï¼Œå‡ºç°ä¸‹é¢çš„ç•Œé¢è¯´æ˜æˆåŠŸï¼š</a></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108191007476.png" alt="image-20201108191007476"></p>
<p><strong>ä¿®æ”¹æœåŠ¡æä¾›è€…8001</strong></p>
<p>1ã€å¼•å…¥actuatorä¾èµ–</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--springboot actuator--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>2ã€é…ç½®æ–‡ä»¶ä¸­å¼€æ”¾healthã€infoã€hystrix.streamç«¯ç‚¹</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">management:</span><br><span class="line">  endpoints:</span><br><span class="line">    web:</span><br><span class="line">      exposure:</span><br><span class="line">        include:</span><br><span class="line">        - <span class="string">'hystrix.stream'</span></span><br><span class="line">        - <span class="string">'health'</span></span><br><span class="line">        - <span class="string">'info'</span></span><br></pre></td></tr></table></figure>

<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108200811541.png" alt="image-20201108200811541"></p>
<p>ç‚¹å‡»Monitor Streamï¼Œå¼€å§‹ç›‘æ§</p>
<blockquote>
<p>å¦‚æœä¸€ç›´loadingï¼Œè¯´æ˜è¿˜æ²¡æœ‰è®¿é—®ç›‘æ§çš„æœåŠ¡ï¼Œè®¿é—®ä¸€ä¸ªå°±å¯ä»¥æ˜¾ç¤ºäº†</p>
</blockquote>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108201052689.png" alt="image-20201108201052689"></p>
<p>æ²¡æœ‰ç†”æ–­å‰çš„è®¿é—®ï¼š</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108201231951.png" alt="image-20201108201231951"></p>
<p>å¯ä»¥çœ‹åˆ°æ­¤æ—¶å¤„äºClosedçŠ¶æ€</p>
<p>è¿ç»­å¤šæ¬¡è®¿é—®è´Ÿæ•°id</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108201325383.png" alt="image-20201108201325383"></p>
<p>æ­¤æ—¶Circuitçš„çŠ¶æ€å·²ç»å˜æˆäº†OpençŠ¶æ€</p>
<p>è¿‡ä¸€æ®µæ—¶é—´ï¼Œè®¿é—®ä¸€ä¸ªæ­£æ•°idï¼Œå‘ç°Circuitåˆå˜æˆäº†ClosedçŠ¶æ€</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108201456442.png" alt="image-20201108201456442"></p>
<h3 id="æ€ä¹ˆçœ‹"><a href="#æ€ä¹ˆçœ‹" class="headerlink" title="æ€ä¹ˆçœ‹"></a>æ€ä¹ˆçœ‹</h3><p><strong>7è‰²</strong></p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108201808068.png" alt="image-20201108201808068"></p>
<p><strong>1åœˆ</strong></p>
<p>å®å¿ƒåœ†ï¼šå…±æœ‰ä¸¤ç§å«ä¹‰ã€‚å®ƒé€šè¿‡é¢œè‰²çš„å˜åŒ–ä»£è¡¨äº†å®ä¾‹çš„å¥åº·ç¨‹åº¦ï¼Œå®ƒçš„å¥åº·ç¨‹åº¦ä»ç»¿è‰²&lt;é»„è‰²&lt;æ©™è‰²&lt;çº¢è‰²é€’å‡ã€‚</p>
<p>è¯¥å®å¿ƒåœ†é™¤äº†é¢œè‰²çš„å˜åŒ–ä¹‹å¤–ï¼Œå®ƒçš„å¤§å°ä¹Ÿä¼šæ ¹æ®å®ä¾‹çš„è¯·æ±‚æµé‡å‘ç”Ÿå˜åŒ–ï¼Œæµé‡è¶Šå¤§è¯¥å®å¿ƒåœ†å°±è¶Šå¤§ã€‚æ‰€ä»¥é€šè¿‡è¯¥å®å¿ƒåœ†çš„å±•ç¤ºï¼Œå°±å¯ä»¥åœ¨å¤§é‡å®ä¾‹ä¸­å¿«é€Ÿå‘ç°<strong>æ•…éšœå®ä¾‹å’Œé«˜å‹åŠ›å®ä¾‹</strong>ã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108202156996.png" alt="image-20201108202156996"></p>
<p><strong>1çº¿</strong></p>
<p>æ›²çº¿ï¼šç”¨æ¥è®°å½•2åˆ†é’Ÿå†…æµé‡çš„ç›¸å¯¹å˜åŒ–ï¼Œå¯ä»¥é€šè¿‡å®ƒæ¥è§‚å¯Ÿåˆ°æµé‡çš„ä¸Šå‡å’Œä¸‹é™è¶‹åŠ¿</p>
<p><img src= "/img/loading.gif" data-src="https://gitee.com/zxwscoffee/img/raw/master/img/image-20201108202310059.png" alt="image-20201108202310059"></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">æŠ˜æœ¨Zxw</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://zxwzxh.github.io/2020/11/05/%E4%B9%9D%E3%80%81Hystrix%E6%96%AD%E8%B7%AF%E5%99%A8/">http://zxwzxh.github.io/2020/11/05/%E4%B9%9D%E3%80%81Hystrix%E6%96%AD%E8%B7%AF%E5%99%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://zxwzxh.github.io" target="_blank">æŠ˜æœ¨Zxw</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Hystrix%E6%96%AD%E8%B7%AF%E5%99%A8/">Hystrixæ–­è·¯å™¨</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/08/%E5%8D%81%E3%80%81%E6%9C%8D%E5%8A%A1%E7%BD%91%E5%85%B3/"><img class="prev-cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">åã€æœåŠ¡ç½‘å…³</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/05/%E5%85%AB%E3%80%81OpenFeign%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8/"><img class="next-cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">å…«ã€OpenFeignæœåŠ¡æ¥å£è°ƒç”¨</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By æŠ˜æœ¨Zxw</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font_plus" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font_minus" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="è®¾ç½®"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>ç”±</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>æä¾›æ”¯æŒ</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
    processEscapes: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
  },
  CommonHTML: {
    linebreaks: { automatic: true, width: "90% container" }
  },
  "HTML-CSS": { 
    linebreaks: { automatic: true, width: "90% container" }
  },
  "SVG": { 
    linebreaks: { automatic: true, width: "90% container" }
  }
});
</script><script type="text/x-mathjax-config">MathJax.Hub.Queue(function() {
  var all = MathJax.Hub.getAllJax(), i;
  for (i=0; i < all.length; i += 1) {
    all[i].SourceElement().parentNode.className += ' has-jax';
  }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script></body></html>